<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Rawsock library: Rawsock_lib/rawsock.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Rawsock_lib_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Rawsock library
   &#160;<span id="projectnumber">v0.3.4</span>
   </div>
   <div id="projectbrief">Library to make the use of raw sockets easier, under Linux. Currently supporting IPv4, UDP and a custom latency measurement protocol (LaMP - supported both in raw and non-raw sockets).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('rawsock_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">rawsock.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rawsock_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifndef RAWSOCK_H_INCLUDED</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#define RAWSOCK_H_INCLUDED</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;net/ethernet.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;linux/udp.h&gt;</span>  </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;linux/ip.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#ifdef __ANDROID__</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">    #define udphdr __kernel_udphdr</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ac7b68a1e0ffd7ae30f3848d1bd582837">   27</a></span>&#160;<span class="preprocessor">#define MAC_FILE_PATH_SIZE 23 </span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ae01dbae885bc8abecb82bd865515c081">   28</a></span>&#160;<span class="preprocessor">#define MAC_ADDR_SIZE 6 </span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">// Errors</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ad6423a4df1e8aed89332dfdf9b6436cb">   31</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_NOIF 0 </span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a52922b300bbc95f471c2cde6e9213a2c">   32</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_SOCK -1 </span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a21e778534653ff83888669f1d6606a5f">   33</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_GETIFADDRS -2 </span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a298bd4822ba623995ce6d17e44dcdb6a">   34</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_INDEX -3 </span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aaefa4462ab0b860b6bd0bbfc22d5cd33">   35</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_GETSRCMAC -4 </span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a93ff51a7c2a9b546fd2453e2132ee133">   36</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_GETIFINDEX -5 </span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa18e60a5bdd3f8649877c4921b08c050">   37</a></span>&#160;<span class="preprocessor">#define ERR_WLAN_GETSRCIP -6 </span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ab5030ae5a9bf30b1f2c4ee41081bdcc2">   39</a></span>&#160;<span class="preprocessor">#define ERR_IPHEAD_SOCK -10 </span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="rawsock_8h.html#afb4547c3913540def3246e79da5e8e01">   40</a></span>&#160;<span class="preprocessor">#define ERR_IPHEAD_NOSRCADDR -11 </span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a4d04863a699cd0ba36a4bad72f87875b">   42</a></span>&#160;<span class="preprocessor">#define ERR_VIFPRINTER_SOCK -20 </span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a29814c440e4009d26f00f2073988f503">   43</a></span>&#160;<span class="preprocessor">#define ERR_VIFPRINTER_GETIFADDRS -21 </span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">// wlanLookup() modes</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa13ccea41ef8a2be5418a024491ab3cb">   46</a></span>&#160;<span class="preprocessor">#define WLANLOOKUP_WLAN 0 </span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a8a4daab19d5e118e848deaa847b17646">   47</a></span>&#160;<span class="preprocessor">#define WLANLOOKUP_NONWLAN 1 </span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">// Names</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="rawsock_8h.html#addf164de7bf1717f1fea7fc8c131df8c">   50</a></span>&#160;<span class="preprocessor">#define MAC_NULL 0x00 </span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ad085edcd01bf33b3ac926fd440ff5faf">   51</a></span>&#160;<span class="preprocessor">#define MAC_BROADCAST 0x01 </span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa97ac5e7eaefc0ee2f00af097bf2ce62">   52</a></span>&#160;<span class="preprocessor">#define MAC_UNICAST 0x02 </span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ac0e8fb4c350b55365bc0fd1b5d79574c">   53</a></span>&#160;<span class="preprocessor">#define MAC_MULTICAST 0x03 </span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a7b505fc6e4743303fac564fe419e11be">   54</a></span>&#160;<span class="preprocessor">#define MAC_ZERO 0x04 </span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">// Useful constants</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// Additional EtherTypes</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa87616dfe8685a4b5f240c19846fe22e">   58</a></span>&#160;<span class="preprocessor">#define ETHERTYPE_GEONET 0x8947 </span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a1c5a3ec926358ac4b8fcd91cf32d9601">   59</a></span>&#160;<span class="preprocessor">#define ETHERTYPE_WSMP 0x88DC </span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">// Special wlanLookup index values</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aff64daee24d50575c816c5d75874d001">   62</a></span>&#160;<span class="preprocessor">#define WLANLOOKUP_LOOPBACK -1 </span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">// IP constants</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a340376f4c1c554ce0ed8a56353245f87">   65</a></span>&#160;<span class="preprocessor">#define BASIC_IHL 5 </span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ae3d82b086c0b0e4ddac202078f01f120">   66</a></span>&#160;<span class="preprocessor">#define IPV4 4 </span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a6ac68536910e3f9ad37e12294f7aaff0">   67</a></span>&#160;<span class="preprocessor">#define BASIC_UDP_TTL 64 </span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">// UDP constant</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a179d15dbd6876292449c2b92d61e35f7">   70</a></span>&#160;<span class="preprocessor">#define UDPHEADERLEN 8 </span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">// Useful masks</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a5483704d4c1b6c832db99ffe700b1345">   73</a></span>&#160;<span class="preprocessor">#define FLAG_NOFRAG_MASK (1&lt;&lt;6) </span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a3d605dd366ed60554963ef178a7787ad">   74</a></span>&#160;<span class="preprocessor">#define FLAG_RESERVED_MASK (1&lt;&lt;7) </span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a078b5997c266ca75d55abbad2d8d7462">   75</a></span>&#160;<span class="preprocessor">#define FLAG_MOREFRAG_MASK (1&lt;&lt;5) </span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">// Checksum protocols, to be used inside the validateEthCsum() function </span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//  (0x00-&gt;0x7F should be simple types, 0x80-&gt;0xFF should be combined types)</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a9c2ebe239a3b502d61f5ba607a8db4e6">   79</a></span>&#160;<span class="preprocessor">#define CSUM_IP 0x00 </span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a848a2c02ec2f354018a998c3d87d2836">   80</a></span>&#160;<span class="preprocessor">#define CSUM_UDP 0x01 </span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa5815136097e443a0a41d35d9c1d5389">   81</a></span>&#160;<span class="preprocessor">#define CSUM_UDPIP 0x80 </span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">// Useful macros for printing MAC addresses inside the printf() familty of functions</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="rawsock_8h.html#adc14ca0cde20d80e340db369d21aa9b9">   84</a></span>&#160;<span class="preprocessor">#define PRI_MAC &quot;%02x:%02x:%02x:%02x:%02x:%02x&quot; </span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a5f6afdfc5a1697437de7c81eec02881a">   85</a></span>&#160;<span class="preprocessor">#define MAC_PRINTER(mac_array) mac_array[0], mac_array[1], mac_array[2], mac_array[3], mac_array[4], mac_array[5] </span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">// Useful macros for reading MAC addresses inside the scanf() familty of functions</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="rawsock_8h.html#ac9b222932e933c2a3dac81ed9aeb8ded">   88</a></span>&#160;<span class="preprocessor">#define SCN_MAC &quot;%x:%x:%x:%x:%x:%x%*c&quot; </span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a8809fd8c4ef6f730bcc908229f08a072">   89</a></span>&#160;<span class="preprocessor">#define MAC_SCANNER(mac_array) &amp;mac_array[0], &amp;mac_array[1], &amp;mac_array[2], &amp;mac_array[3], &amp;mac_array[4], &amp;mac_array[5] </span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">// Size definitions (macros)</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="rawsock_8h.html#acbbb2b8b10ab4740a9f6c62b93cfef66">   92</a></span>&#160;<span class="preprocessor">#define UDP_PACKET_SIZE(data) sizeof(struct udphdr)+sizeof(data)  </span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="rawsock_8h.html#af556407e9c582f485d45f219df9cfc1f">   93</a></span>&#160;<span class="preprocessor">#define IP_UDP_PACKET_SIZE(data) sizeof(struct iphdr)+sizeof(struct udphdr)+sizeof(data) </span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a6fe57c8dc5a044a3a1fdfae20ccc8bad">   94</a></span>&#160;<span class="preprocessor">#define ETH_IP_UDP_PACKET_SIZE(data) sizeof(struct ether_header)+sizeof(struct iphdr)+sizeof(struct udphdr)+sizeof(data) </span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a20da24fd44ae674c4d8373e58685c573">   96</a></span>&#160;<span class="preprocessor">#define UDP_PACKET_SIZE_S(size) sizeof(struct udphdr)+size </span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="rawsock_8h.html#af223f5e314af4eabc6d66cc8ee02a3a0">   97</a></span>&#160;<span class="preprocessor">#define IP_UDP_PACKET_SIZE_S(size) sizeof(struct iphdr)+sizeof(struct udphdr)+size </span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a66f2e41ccb093addf0db42970af74b42">   98</a></span>&#160;<span class="preprocessor">#define ETH_IP_UDP_PACKET_SIZE_S(size) sizeof(struct ether_header)+sizeof(struct iphdr)+sizeof(struct udphdr)+size </span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#ifndef BYTE_TYPE</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#define BYTE_TYPE</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">  102</a></span>&#160;<span class="keyword">typedef</span> uint8_t <a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a>; </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">  105</a></span>&#160;<span class="keyword">typedef</span> uint8_t * <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a>; </div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a23bd834253bb70c8f0f64c79aed350b9">  106</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="rawsock_8h.html#a23bd834253bb70c8f0f64c79aed350b9">ethertype_t</a>; </div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">  107</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a>; </div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="rawsock_8h.html#aa2241201dc140b721a522eaf39d9e527">  108</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="rawsock_8h.html#aa2241201dc140b721a522eaf39d9e527">csumt_t</a>; </div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a71cbed2832d72fff127aa670c21cd79b">  109</a></span>&#160;<span class="keyword">typedef</span> __sum16 <a class="code" href="rawsock_8h.html#a71cbed2832d72fff127aa670c21cd79b">csum16_t</a>; </div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structipaddrs.html">  115</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structipaddrs.html">ipaddrs</a> {</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structipaddrs.html#a9c84f94b308ea78720f4cbae62a37f01">  116</a></span>&#160;    in_addr_t <a class="code" href="structipaddrs.html#a9c84f94b308ea78720f4cbae62a37f01">src</a>; </div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structipaddrs.html#a7a03333fe228c78e95843517e3d9e670">  117</a></span>&#160;    in_addr_t <a class="code" href="structipaddrs.html#a7a03333fe228c78e95843517e3d9e670">dst</a>; </div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;};</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5f">  125</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa0e207f13266615a67248e0872a857e22">  126</a></span>&#160;    <a class="code" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa0e207f13266615a67248e0872a857e22">UNSET_P</a>,    </div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fadb542475cf9d0636e4225e216cee9ae6">  127</a></span>&#160;    <a class="code" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fadb542475cf9d0636e4225e216cee9ae6">UDP</a>,        </div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5faab84bdffa9f13502c4a851f15c80a90c">  128</a></span>&#160;    <a class="code" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5faab84bdffa9f13502c4a851f15c80a90c">AMQP_0_9</a>,   </div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa99b2d1c97e1d5b77bc8038106a70c053">  129</a></span>&#160;    <a class="code" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa99b2d1c97e1d5b77bc8038106a70c053">AMQP_1_0</a>    </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;} <a class="code" href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5f">protocol_t</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">// General utilities</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> <a class="code" href="rawsock_8h.html#a67042209a2494ae4c50c5e4317888226">wlanLookup</a>(<span class="keywordtype">char</span> *devname, <span class="keywordtype">int</span> *ifindex, <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> mac, <span class="keyword">struct</span> in_addr *srcIP, <span class="keywordtype">int</span> index, <span class="keywordtype">int</span> mode);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> <a class="code" href="rawsock_8h.html#aad9c02628ca1d54590c3bececec86b57">vifPrinter</a>(FILE *stream);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> <a class="code" href="rawsock_8h.html#af9ffe247a4f65a16e4bf123104e8105e">prepareMacAddrT</a>();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="rawsock_8h.html#af86e3c8e9300732f7222fcce3b08adad">macAddrTypeGet</a>(<a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> mac);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#aed9676022fd046d34e243cf52cfd8255">freeMacAddrT</a>(<a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> mac);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#af596c860215789d5a99e419fa69a0500">rs_printerror</a>(FILE *stream,<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> code);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a1ca9119d2c4568914340756b5dbeb7ce">display_packet</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *text,<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a42af111446f0e87c3e72e1cba60d3a24">display_packetc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *text,<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;uint64_t <a class="code" href="rawsock_8h.html#a02a011504fe087e9d13aff96a26017c7">hton64</a> (uint64_t hostu64); <span class="comment">// Like &#39;htonl()&#39; but for 64-bits unsigned integers</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;uint64_t <a class="code" href="rawsock_8h.html#a452c0159838860279d7f195c96ca01f2">ntoh64</a> (uint64_t netu64); <span class="comment">// Like &#39;ntohl()&#39; but for 64-bits unsigned integers</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// Ethernet level functions</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a6dda4611a853da42435df9a025266641">etherheadPopulateB</a>(<span class="keyword">struct</span> ether_header *etherHeader, <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> mac, <a class="code" href="rawsock_8h.html#a23bd834253bb70c8f0f64c79aed350b9">ethertype_t</a> type);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#ac70b54da68a91bb811cf57d2c27381fd">etherheadPopulate</a>(<span class="keyword">struct</span> ether_header *etherHeader, <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> macsrc, <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> macdst, <a class="code" href="rawsock_8h.html#a23bd834253bb70c8f0f64c79aed350b9">ethertype_t</a> type);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rawsock_8h.html#a3551ee96011895ab6e895381782cb138">etherEncapsulate</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet,<span class="keyword">struct</span> ether_header *header,<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *sdu,<span class="keywordtype">size_t</span> sdusize);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a14ac66b8c5b58a37f5cbfabec68e317c">getSrcMAC</a>(<span class="keyword">struct</span> ether_header *etherHeader, <a class="code" href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a> macsrc);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">// IP level functions</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> <a class="code" href="rawsock_8h.html#ae696dee7a0ca07e0872c7e56595e5553">IP4headPopulateB</a>(<span class="keyword">struct</span> iphdr *IPhead, <span class="keywordtype">char</span> *devname,<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tos,<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> frag_offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ttl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> protocol,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags,<span class="keyword">struct</span> <a class="code" href="structipaddrs.html">ipaddrs</a> *addrs);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> <a class="code" href="rawsock_8h.html#acbddc8a0001b2c08908f266d3436e3f0">IP4headPopulateS</a>(<span class="keyword">struct</span> iphdr *IPhead, <span class="keywordtype">char</span> *devname, <span class="keyword">struct</span> in_addr destIP, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tos,<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> frag_offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ttl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> protocol,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags,<span class="keyword">struct</span> <a class="code" href="structipaddrs.html">ipaddrs</a> *addrs);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<a class="code" href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a> <a class="code" href="rawsock_8h.html#a166eb0daab0e332b134c1dff449a9271">IP4headPopulate</a>(<span class="keyword">struct</span> iphdr *IPhead, <span class="keywordtype">char</span> *devname, <span class="keywordtype">char</span> *destIP, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tos,<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> frag_offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ttl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> protocol,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags,<span class="keyword">struct</span> <a class="code" href="structipaddrs.html">ipaddrs</a> *addrs);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a30db7ab77625aba3abe06ae33c892715">IP4headAddID</a>(<span class="keyword">struct</span> iphdr *IPhead, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#aeea7cc65afcd15945e6be31ec0a7f136">IP4headAddTotLen</a>(<span class="keyword">struct</span> iphdr *IPhead, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> len);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rawsock_8h.html#a5117600ef5b7603bd169e16a4d305bfa">IP4Encapsulate</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet,<span class="keyword">struct</span> iphdr *header,<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *sdu,<span class="keywordtype">size_t</span> sdusize);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// UDP level functions</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a6eb7d52837b679a35c818cb2cd93a569">UDPheadPopulate</a>(<span class="keyword">struct</span> udphdr *UDPhead, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> sourceport, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> destport);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rawsock_8h.html#af66696d8e4ee2eb7d09a1eed9497b452">UDPencapsulate</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet,<span class="keyword">struct</span> udphdr *header,<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *data,<span class="keywordtype">size_t</span> payloadsize,<span class="keyword">struct</span> <a class="code" href="structipaddrs.html">ipaddrs</a> addrs);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">// Receiving device functions</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *<a class="code" href="rawsock_8h.html#a73f90608054cccd554921c8237479aa2">UDPgetpacketpointers</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *pktbuf,<span class="keyword">struct</span> ether_header **etherHeader, <span class="keyword">struct</span> iphdr **IPheader,<span class="keyword">struct</span> udphdr **UDPheader);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="rawsock_8h.html#a64420c632f0fa00e99aa66db3099823f">UDPgetpayloadsize</a>(<span class="keyword">struct</span> udphdr *UDPheader);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="rawsock_8h.html#abb14def1a9dd5a7393b77391dddeca13">validateEthCsum</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *packet, <a class="code" href="rawsock_8h.html#a71cbed2832d72fff127aa670c21cd79b">csum16_t</a> csum, <a class="code" href="rawsock_8h.html#a71cbed2832d72fff127aa670c21cd79b">csum16_t</a> *combinedcsum, <a class="code" href="rawsock_8h.html#aa2241201dc140b721a522eaf39d9e527">csumt_t</a> type, <span class="keywordtype">void</span> *args);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// Test functions, to inject errors inside packets - should never be used under normal circumstances</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#a40bb53171777fd6d4ade834c512519c5">test_injectIPCsumError</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *IPpacket);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordtype">void</span> <a class="code" href="rawsock_8h.html#aa2a34461395e274047f3c605b0aa16b4">test_injectUDPCsumError</a>(<a class="code" href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a> *UDPpacket);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="rawsock_8h_html_a91e19fa4fff461493e1a41f7c7aa4e5faab84bdffa9f13502c4a851f15c80a90c"><div class="ttname"><a href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5faab84bdffa9f13502c4a851f15c80a90c">AMQP_0_9</a></div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00128">rawsock.h:128</a></div></div>
<div class="ttc" id="rawsock_8h_html_a1ca9119d2c4568914340756b5dbeb7ce"><div class="ttname"><a href="rawsock_8h.html#a1ca9119d2c4568914340756b5dbeb7ce">display_packet</a></div><div class="ttdeci">void display_packet(const char *text, byte_t *packet, unsigned int len)</div><div class="ttdoc">Display packet in hexadecimal form. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00459">rawsock.c:459</a></div></div>
<div class="ttc" id="rawsock_8h_html_a3551ee96011895ab6e895381782cb138"><div class="ttname"><a href="rawsock_8h.html#a3551ee96011895ab6e895381782cb138">etherEncapsulate</a></div><div class="ttdeci">size_t etherEncapsulate(byte_t *packet, struct ether_header *header, byte_t *sdu, size_t sdusize)</div><div class="ttdoc">Combine Ethernet SDU and PCI. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00612">rawsock.c:612</a></div></div>
<div class="ttc" id="rawsock_8h_html_aa2241201dc140b721a522eaf39d9e527"><div class="ttname"><a href="rawsock_8h.html#aa2241201dc140b721a522eaf39d9e527">csumt_t</a></div><div class="ttdeci">unsigned char csumt_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00108">rawsock.h:108</a></div></div>
<div class="ttc" id="rawsock_8h_html_ac70b54da68a91bb811cf57d2c27381fd"><div class="ttname"><a href="rawsock_8h.html#ac70b54da68a91bb811cf57d2c27381fd">etherheadPopulate</a></div><div class="ttdeci">void etherheadPopulate(struct ether_header *etherHeader, macaddr_t macsrc, macaddr_t macdst, ethertype_t type)</div><div class="ttdoc">Populate Ethernet header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00587">rawsock.c:587</a></div></div>
<div class="ttc" id="rawsock_8h_html_a5117600ef5b7603bd169e16a4d305bfa"><div class="ttname"><a href="rawsock_8h.html#a5117600ef5b7603bd169e16a4d305bfa">IP4Encapsulate</a></div><div class="ttdeci">size_t IP4Encapsulate(byte_t *packet, struct iphdr *header, byte_t *sdu, size_t sdusize)</div><div class="ttdoc">Combine IPv4 SDU and PCI. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00926">rawsock.c:926</a></div></div>
<div class="ttc" id="rawsock_8h_html_a6dda4611a853da42435df9a025266641"><div class="ttname"><a href="rawsock_8h.html#a6dda4611a853da42435df9a025266641">etherheadPopulateB</a></div><div class="ttdeci">void etherheadPopulateB(struct ether_header *etherHeader, macaddr_t mac, ethertype_t type)</div><div class="ttdoc">Populate broadcast Ethernet header (variant of etherheadPopulate()) </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00556">rawsock.c:556</a></div></div>
<div class="ttc" id="rawsock_8h_html_a14ac66b8c5b58a37f5cbfabec68e317c"><div class="ttname"><a href="rawsock_8h.html#a14ac66b8c5b58a37f5cbfabec68e317c">getSrcMAC</a></div><div class="ttdeci">void getSrcMAC(struct ether_header *etherHeader, macaddr_t macsrc)</div><div class="ttdoc">Retrieve source MAC address field from Ethernet header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00633">rawsock.c:633</a></div></div>
<div class="ttc" id="rawsock_8h_html_af86e3c8e9300732f7222fcce3b08adad"><div class="ttname"><a href="rawsock_8h.html#af86e3c8e9300732f7222fcce3b08adad">macAddrTypeGet</a></div><div class="ttdeci">unsigned int macAddrTypeGet(macaddr_t mac)</div><div class="ttdoc">Get the MAC address type. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00096">rawsock.c:96</a></div></div>
<div class="ttc" id="rawsock_8h_html_a452c0159838860279d7f195c96ca01f2"><div class="ttname"><a href="rawsock_8h.html#a452c0159838860279d7f195c96ca01f2">ntoh64</a></div><div class="ttdeci">uint64_t ntoh64(uint64_t netu64)</div><div class="ttdoc">Convert a 64-bit unsigned value between network and host byte order. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00532">rawsock.c:532</a></div></div>
<div class="ttc" id="structipaddrs_html"><div class="ttname"><a href="structipaddrs.html">ipaddrs</a></div><div class="ttdoc">Structure to store a couple of source and destinaion IPv4 addresses. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00115">rawsock.h:115</a></div></div>
<div class="ttc" id="rawsock_8h_html_af9ffe247a4f65a16e4bf123104e8105e"><div class="ttname"><a href="rawsock_8h.html#af9ffe247a4f65a16e4bf123104e8105e">prepareMacAddrT</a></div><div class="ttdeci">macaddr_t prepareMacAddrT()</div><div class="ttdoc">Prepare a macaddr_t variable. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00054">rawsock.c:54</a></div></div>
<div class="ttc" id="rawsock_8h_html_a7516f6c5689b1c204b2bb4f05b09e1cf"><div class="ttname"><a href="rawsock_8h.html#a7516f6c5689b1c204b2bb4f05b09e1cf">macaddr_t</a></div><div class="ttdeci">uint8_t * macaddr_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00105">rawsock.h:105</a></div></div>
<div class="ttc" id="rawsock_8h_html_aed9676022fd046d34e243cf52cfd8255"><div class="ttname"><a href="rawsock_8h.html#aed9676022fd046d34e243cf52cfd8255">freeMacAddrT</a></div><div class="ttdeci">void freeMacAddrT(macaddr_t mac)</div><div class="ttdoc">Free a macaddr_t variable. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00078">rawsock.c:78</a></div></div>
<div class="ttc" id="rawsock_8h_html_abb14def1a9dd5a7393b77391dddeca13"><div class="ttname"><a href="rawsock_8h.html#abb14def1a9dd5a7393b77391dddeca13">validateEthCsum</a></div><div class="ttdeci">bool validateEthCsum(byte_t *packet, csum16_t csum, csum16_t *combinedcsum, csumt_t type, void *args)</div><div class="ttdoc">Validate the checksum of a raw &quot;Ethernet&quot; packet, i.e. of any packet containing a struct ether_header...</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l01099">rawsock.c:1099</a></div></div>
<div class="ttc" id="rawsock_8h_html_a02a011504fe087e9d13aff96a26017c7"><div class="ttname"><a href="rawsock_8h.html#a02a011504fe087e9d13aff96a26017c7">hton64</a></div><div class="ttdeci">uint64_t hton64(uint64_t hostu64)</div><div class="ttdoc">Convert a 64-bit unsigned value between host and network byte order. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00513">rawsock.c:513</a></div></div>
<div class="ttc" id="rawsock_8h_html_af596c860215789d5a99e419fa69a0500"><div class="ttname"><a href="rawsock_8h.html#af596c860215789d5a99e419fa69a0500">rs_printerror</a></div><div class="ttdeci">void rs_printerror(FILE *stream, rawsockerr_t code)</div><div class="ttdoc">Print more detailed error messages. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00399">rawsock.c:399</a></div></div>
<div class="ttc" id="rawsock_8h_html_ae696dee7a0ca07e0872c7e56595e5553"><div class="ttname"><a href="rawsock_8h.html#ae696dee7a0ca07e0872c7e56595e5553">IP4headPopulateB</a></div><div class="ttdeci">rawsockerr_t IP4headPopulateB(struct iphdr *IPhead, char *devname, unsigned char tos, unsigned short frag_offset, unsigned char ttl, unsigned char protocol, unsigned int flags, struct ipaddrs *addrs)</div><div class="ttdoc">Populate broadcast IP version 4 header (variant of IP4headPopulate()) </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00830">rawsock.c:830</a></div></div>
<div class="ttc" id="rawsock_8h_html_a71cbed2832d72fff127aa670c21cd79b"><div class="ttname"><a href="rawsock_8h.html#a71cbed2832d72fff127aa670c21cd79b">csum16_t</a></div><div class="ttdeci">__sum16 csum16_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00109">rawsock.h:109</a></div></div>
<div class="ttc" id="rawsock_8h_html_aad9c02628ca1d54590c3bececec86b57"><div class="ttname"><a href="rawsock_8h.html#aad9c02628ca1d54590c3bececec86b57">vifPrinter</a></div><div class="ttdeci">rawsockerr_t vifPrinter(FILE *stream)</div><div class="ttdoc">Print information about available interfaces. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00327">rawsock.c:327</a></div></div>
<div class="ttc" id="rawsock_8h_html_a91e19fa4fff461493e1a41f7c7aa4e5f"><div class="ttname"><a href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5f">protocol_t</a></div><div class="ttdeci">protocol_t</div><div class="ttdoc">Protocol type enumerator. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00125">rawsock.h:125</a></div></div>
<div class="ttc" id="rawsock_8h_html_a6eb7d52837b679a35c818cb2cd93a569"><div class="ttname"><a href="rawsock_8h.html#a6eb7d52837b679a35c818cb2cd93a569">UDPheadPopulate</a></div><div class="ttdeci">void UDPheadPopulate(struct udphdr *UDPhead, unsigned short sourceport, unsigned short destport)</div><div class="ttdoc">Populate UDP header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00960">rawsock.c:960</a></div></div>
<div class="ttc" id="rawsock_8h_html_a91e19fa4fff461493e1a41f7c7aa4e5fa0e207f13266615a67248e0872a857e22"><div class="ttname"><a href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa0e207f13266615a67248e0872a857e22">UNSET_P</a></div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00126">rawsock.h:126</a></div></div>
<div class="ttc" id="rawsock_8h_html_a40bb53171777fd6d4ade834c512519c5"><div class="ttname"><a href="rawsock_8h.html#a40bb53171777fd6d4ade834c512519c5">test_injectIPCsumError</a></div><div class="ttdeci">void test_injectIPCsumError(byte_t *IPpacket)</div><div class="ttdoc">Test function: inject a checksum error in an IP packet. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l01185">rawsock.c:1185</a></div></div>
<div class="ttc" id="rawsock_8h_html_a67042209a2494ae4c50c5e4317888226"><div class="ttname"><a href="rawsock_8h.html#a67042209a2494ae4c50c5e4317888226">wlanLookup</a></div><div class="ttdeci">rawsockerr_t wlanLookup(char *devname, int *ifindex, macaddr_t mac, struct in_addr *srcIP, int index, int mode)</div><div class="ttdoc">Automatically look for available WLAN, non-WLAN or loopback interfaces. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00149">rawsock.c:149</a></div></div>
<div class="ttc" id="rawsock_8h_html_a91e19fa4fff461493e1a41f7c7aa4e5fa99b2d1c97e1d5b77bc8038106a70c053"><div class="ttname"><a href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fa99b2d1c97e1d5b77bc8038106a70c053">AMQP_1_0</a></div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00129">rawsock.h:129</a></div></div>
<div class="ttc" id="rawsock_8h_html_a64420c632f0fa00e99aa66db3099823f"><div class="ttname"><a href="rawsock_8h.html#a64420c632f0fa00e99aa66db3099823f">UDPgetpayloadsize</a></div><div class="ttdeci">unsigned short UDPgetpayloadsize(struct udphdr *UDPheader)</div><div class="ttdoc">Get UDP payload size, given a UDP header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l01060">rawsock.c:1060</a></div></div>
<div class="ttc" id="rawsock_8h_html_acbddc8a0001b2c08908f266d3436e3f0"><div class="ttname"><a href="rawsock_8h.html#acbddc8a0001b2c08908f266d3436e3f0">IP4headPopulateS</a></div><div class="ttdeci">rawsockerr_t IP4headPopulateS(struct iphdr *IPhead, char *devname, struct in_addr destIP, unsigned char tos, unsigned short frag_offset, unsigned char ttl, unsigned char protocol, unsigned int flags, struct ipaddrs *addrs)</div><div class="ttdoc">Populate IP version 4 header with struct in_addr addresses (variant of IP4headPopulate()) ...</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00755">rawsock.c:755</a></div></div>
<div class="ttc" id="rawsock_8h_html_a91e19fa4fff461493e1a41f7c7aa4e5fadb542475cf9d0636e4225e216cee9ae6"><div class="ttname"><a href="rawsock_8h.html#a91e19fa4fff461493e1a41f7c7aa4e5fadb542475cf9d0636e4225e216cee9ae6">UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00127">rawsock.h:127</a></div></div>
<div class="ttc" id="rawsock_8h_html_a0661d7d1353e0bca70c64563f635b034"><div class="ttname"><a href="rawsock_8h.html#a0661d7d1353e0bca70c64563f635b034">byte_t</a></div><div class="ttdeci">uint8_t byte_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00102">rawsock.h:102</a></div></div>
<div class="ttc" id="structipaddrs_html_a9c84f94b308ea78720f4cbae62a37f01"><div class="ttname"><a href="structipaddrs.html#a9c84f94b308ea78720f4cbae62a37f01">ipaddrs::src</a></div><div class="ttdeci">in_addr_t src</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00116">rawsock.h:116</a></div></div>
<div class="ttc" id="rawsock_8h_html_af66696d8e4ee2eb7d09a1eed9497b452"><div class="ttname"><a href="rawsock_8h.html#af66696d8e4ee2eb7d09a1eed9497b452">UDPencapsulate</a></div><div class="ttdeci">size_t UDPencapsulate(byte_t *packet, struct udphdr *header, byte_t *data, size_t payloadsize, struct ipaddrs addrs)</div><div class="ttdoc">Combine UDP payload and header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00988">rawsock.c:988</a></div></div>
<div class="ttc" id="rawsock_8h_html_aeea7cc65afcd15945e6be31ec0a7f136"><div class="ttname"><a href="rawsock_8h.html#aeea7cc65afcd15945e6be31ec0a7f136">IP4headAddTotLen</a></div><div class="ttdeci">void IP4headAddTotLen(struct iphdr *IPhead, unsigned short len)</div><div class="ttdoc">Add Total Length to a given IPv4 header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00904">rawsock.c:904</a></div></div>
<div class="ttc" id="rawsock_8h_html_a23bd834253bb70c8f0f64c79aed350b9"><div class="ttname"><a href="rawsock_8h.html#a23bd834253bb70c8f0f64c79aed350b9">ethertype_t</a></div><div class="ttdeci">unsigned short ethertype_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00106">rawsock.h:106</a></div></div>
<div class="ttc" id="rawsock_8h_html_a69f2206781eb90dcf48b8be85a62f900"><div class="ttname"><a href="rawsock_8h.html#a69f2206781eb90dcf48b8be85a62f900">rawsockerr_t</a></div><div class="ttdeci">int rawsockerr_t</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00107">rawsock.h:107</a></div></div>
<div class="ttc" id="structipaddrs_html_a7a03333fe228c78e95843517e3d9e670"><div class="ttname"><a href="structipaddrs.html#a7a03333fe228c78e95843517e3d9e670">ipaddrs::dst</a></div><div class="ttdeci">in_addr_t dst</div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8h_source.html#l00117">rawsock.h:117</a></div></div>
<div class="ttc" id="rawsock_8h_html_a30db7ab77625aba3abe06ae33c892715"><div class="ttname"><a href="rawsock_8h.html#a30db7ab77625aba3abe06ae33c892715">IP4headAddID</a></div><div class="ttdeci">void IP4headAddID(struct iphdr *IPhead, unsigned short id)</div><div class="ttdoc">Add ID to a given IPv4 header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00886">rawsock.c:886</a></div></div>
<div class="ttc" id="rawsock_8h_html_aa2a34461395e274047f3c605b0aa16b4"><div class="ttname"><a href="rawsock_8h.html#aa2a34461395e274047f3c605b0aa16b4">test_injectUDPCsumError</a></div><div class="ttdeci">void test_injectUDPCsumError(byte_t *UDPpacket)</div><div class="ttdoc">Test function: inject a checksum error in an UDP packet. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l01211">rawsock.c:1211</a></div></div>
<div class="ttc" id="rawsock_8h_html_a166eb0daab0e332b134c1dff449a9271"><div class="ttname"><a href="rawsock_8h.html#a166eb0daab0e332b134c1dff449a9271">IP4headPopulate</a></div><div class="ttdeci">rawsockerr_t IP4headPopulate(struct iphdr *IPhead, char *devname, char *destIP, unsigned char tos, unsigned short frag_offset, unsigned char ttl, unsigned char protocol, unsigned int flags, struct ipaddrs *addrs)</div><div class="ttdoc">Populate IP version 4 header. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00678">rawsock.c:678</a></div></div>
<div class="ttc" id="rawsock_8h_html_a42af111446f0e87c3e72e1cba60d3a24"><div class="ttname"><a href="rawsock_8h.html#a42af111446f0e87c3e72e1cba60d3a24">display_packetc</a></div><div class="ttdeci">void display_packetc(const char *text, byte_t *packet, unsigned int len)</div><div class="ttdoc">Display packet in character form. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l00487">rawsock.c:487</a></div></div>
<div class="ttc" id="rawsock_8h_html_a73f90608054cccd554921c8237479aa2"><div class="ttname"><a href="rawsock_8h.html#a73f90608054cccd554921c8237479aa2">UDPgetpacketpointers</a></div><div class="ttdeci">byte_t * UDPgetpacketpointers(byte_t *pktbuf, struct ether_header **etherHeader, struct iphdr **IPheader, struct udphdr **UDPheader)</div><div class="ttdoc">Get pointers to headers and payload in UDP packet buffer. </div><div class="ttdef"><b>Definition:</b> <a href="rawsock_8c_source.html#l01034">rawsock.c:1034</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_22e672335d01195fb093ee3980f2d937.html">Rawsock_lib</a></li><li class="navelem"><a class="el" href="rawsock_8h.html">rawsock.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
